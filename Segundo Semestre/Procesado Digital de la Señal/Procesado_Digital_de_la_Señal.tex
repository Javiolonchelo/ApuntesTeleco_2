\documentclass[a4paper]{book}

\input{../../Archivos comunes/Preamble.tex} % Se incluye el preámbulo

% Título y portada
\title{\Huge Procesado Digital de la Señal\\\vspace*{5pt}
\Large Apuntes de clase}
\author{Javier Rodrigo López \thanks{Correo electrónico: \href{mailto:javiolonchelo@gmail.com}{\texttt{javiolonchelo@gmail.com}}}} 
\date{\today}

%%% INICIO DEL DOCUMENTO %%%
\begin{document}

\setlength{\wpYoffset}{-0.5cm}
\ThisCenterWallPaper{0.7}{./Imágenes/Velazquez.jpg}
\maketitle

\titleformat{\chapter}[block]
{\normalfont\Huge\bfseries}{TEMA \thechapter.}{1em}{}

% Marca de agua
\AddToShipoutPictureFG{
	\begin{tikzpicture}[overlay,remember picture]
		\path (current page.south west) -- (current page.north east)
		node[midway,scale=8,color=lightgray,sloped,opacity=0.05] {Javier Rodrigo López};
	\end{tikzpicture}
}

% Logotipos UPM y ETSIST
\begin{figure}[t!]
	\centering
	\begin{subfigure}[b]{0.65\linewidth}
		\includegraphics[width=\linewidth]{../../Archivos comunes/upm_logo.png}
	\end{subfigure}
	\begin{subfigure}[b]{0.25\linewidth}
		\includegraphics[width=\linewidth]{../../Archivos comunes/etsist_logo.png}
	\end{subfigure}
\end{figure}

% Introducción
\newpage
\phantomsection
\addcontentsline{toc}{section}{Introducción}
\section*{Introducción}
Imagen de la portada: \textsl{La fragua de Vulcano}, por Diego Velázquez.

Profesores del grupo G6T2TL:
\begin{itemize}
	\item  \href{mailto:cesar.diazm@upm.es}{César Díaz Martín}
	\item \href{mailto:eduardo.latorre.iglesias@upm.es}{Eduardo Latorre Iglesias}
\end{itemize}

\subsubsection{Metodología} \vspace{\parskip}
\begin{itemize}
	\item Teoría
	      \begin{itemize}
		      \item 13 semanas x 2h + 1 semana x 2h
		      \item Evaluación continua: 3 test de 30 minutos cada uno
	      \end{itemize}
	\item Laboratorio
	      \begin{itemize}
		      \item 2 exámenes
		      \item 5 prácticas
	      \end{itemize}
\end{itemize}

\subsubsection{Evaluación} \vspace{\parskip}
Asistencia no obligatoria (pero recomendada)
Sin nota mínima en ningún apartado.

\begingroup
\renewcommand{\arraystretch}{1.2}
\begin{center}
	\begin{tabular}{c | c }
		                 & Evaluación continua \\ \hline
		                 & Test 1 (4\%)        \\
		Teoría           & Test 2 (6\%)        \\
		70\%             & Test 3 (10\%)       \\
		                 & Examen final (50\%) \\ \hline
		                 & (5\%)               \\
		Laboratorio 30\% & (10\%)              \\
		                 & (15\%)              \\
	\end{tabular}
\end{center}
\endgroup

\subsubsection{Conocimientos previos} \vspace{\parskip}
\begin{itemize}
	\item Operaciones con números complejos
	      \begin{itemize}
		      \item Conversión de formatos (parte real-imaginaria y módulo-fase)
		      \item Fórmula de Euler y exponenciales complejas
	      \end{itemize}
	\item Conceptos matemáticos
	      \begin{itemize}
		      \item Representación de funciones complejas (módulo y fase)
		      \item baia la cabaia
	      \end{itemize}
	\item Señales y Sistemas
\end{itemize}

\subsubsection{Lista de tareas} \vspace{\parskip}
\begin{enumerate}
	\item Cambiar el índice según la asignatura.
	\item Organizar los PDFs descargados.
	\item Mirar calendario para cuadrar laboratorios.
	\item Incluir lo que falta de los conocimientos previos.
	\item Descargar bibliografía.
	\item Descargar exámenes y resto del material.
	\item Añadir ejemplos diapositiva 9-10.
\end{enumerate}
\newpage

% Índice (TOC)
\setlength{\parskip}{0em}
\tableofcontents
\setlength{\parskip}{0.5em}

%%% INICIO DE LOS APUNTES %%%

\chapter*{Transformada de Fourier\\ y Muestreo}

\section{Introducción a la Transformada de Fourier}

La transformada de Fourier nos servirá para representar señales como combinación lineal de unos ciertos componentes o señales básicas.

La aplicación fundamental del análisis de Fourier es el estudio de las señales en el dominio de la frecuencia (\textbf{dominio espectral}).

El análisis de Fourier se puede realizar para:
\begin{itemize}
	\item Señales continuas:
	      \begin{itemize}
		      \item Periódicas: Serie de Fourier de tiempo continuo
		      \item No periódicas: Transformada de Fourier en tiempo discreto
	      \end{itemize}
	\item Señales discretas
\end{itemize}

\section{Series de Fourier de señales periódicas}
Sea $x(t)$ una señal periódica, de periodo $T_o$. Esta señal puede expresarse como una combinación lineal de exponenciales complejas (serie de Fourier).

La \textbf{ecuación de síntesis} es la siguiente:
\begin{equation}
	x(t) = \sum_{k=-\infty}^{\infty}a_k e^{jk\omega _o t}
\end{equation}

Los pesos $a_k$ se denominan \textbf{coeficientes espectrales} y determinan qué cantidad de energía reside en cada frecuencia. Se calculan mediante la \textbf{ecuación de análisis}:
\[  \]

Notas.
\begin{itemize}
	\item Coeficientes hermíticos
	\item baia la cabaia
\end{itemize}

Añadir ejemplos para el seno y el coseno (se hace mediante la fórmula de Euler).

\subsection{Fenómeno de Gibbs}

En una señal que necesite infinitos coeficientes de Fourier para ser representada de forma exacta, al coger solo un conjunto de los coeficientes se produce un "rizado" en ciertos puntos de la señal, con amplitud independiente del número de coeficientes escogidos. Esto es el fenómeno de Gibbs

\section{Transformada de Fourier para señales no periódicas}

Si tenemos una señal no periódica. Si intentamos hacerla periódica repitiéndola cada $T$ y luego hacemos que este tiempo $T$ tienda a infinito, tenemos la transformada de Fourier.

AÑADIR FÓRMULAS
Ecuación de síntesis (transformada de Fourier inversa)
Ecuación de análisis

\subsection{Propiedades de la transformada de Fourier}
HAY QUE EXPLICARLAS

Propiedad de convolución: Convolución en el tiempo es multiplicación en frecuencia.

Propiedad de modulación: Multiplicación en el tiempo es convolución en frecuencia.

Añadir ejemplo

\section{Transformada de Fourier de señales periódicas}

La transformada de Fourier de una señal periódica es una combinación lineal de deltas.

EJEMPLO IMPORTANTE (en este ejemplo se basa el muestreo)
Se calcula $a_k$
\subsection{Algunos pares transformados}

La transformada de un pulso siempre es una sinc.
La transformada inversa de una sinc siempre es un pulso.

\chapter{Procesado digital de señales analógicas}

\section{Tipos de señal} \vspace{\parskip}

\subsection{Señales continuas}

En una señal periódica, podemos obtener el \textbf{periodo} como el mínimo común múltiplo de los periodos de sus componentes. Un ejemplo:

\[ x(t) = 3 \sen \left( 5\pi t + \frac{\pi}{4} \right) + \cos \left( 10\pi t \right)\, ;\qquad \omega_1 = 5\pi \, , \quad \omega_2 = 10\pi \]
\[ T = \mcm \left( \frac{2\pi}{\omega_1} \, , \frac{2\pi}{\omega_2} \right) = \mcm \left( \frac{2\pi}{5\pi} \, , \frac{2\pi}{10\pi} \right) = \mcm \left( \frac{2}{5} \, , \frac{1}{5} \right) = \frac{1}{5} \mcm \left( 2 \, , 1 \right) = \boxed{\frac{2}{5} \, \unit{\s}}\]

\subsection{Señales discretas}

El \textbf{periodo} de una señal discreta se obtiene de forma similar a las señales continuas. Sin embargo, cuando el resultado es una fracción el periodo se calcula como el numerador de dicha fracción.

Siguiendo con el ejemplo anterior, a partir de la última fracción obtenida:
\[ \frac{N}{m} = \frac{2}{5} \quad \Longrightarrow \quad \boxed{N = 2} \]

\section{Filtros}

Un \textbf{filtro} es cualquier sistema que modifica la forma de la señal, tanto en su amplitud como en su fase, del modo deseado. Los catalogamos como \textbf{FIR}\footnote{FIR $\equiv$ \textit{Finite Impulse Response.}} o \textbf{IIR}\footnote{IIR $\equiv$ \textit{Infinite Impulse Response.}}, en función de su respuesta al impulso.

Hablaremos de ellos con profundidad en el Tema \ref{temaDeFiltros}.

\section{Estructura de un sistema PDS}

A continuación, se encuentra representado el esquema general de un sistema PDS:

\begin{figure}[ht]
	\centering
	\begin{tikzpicture}[auto,>=latex']
		\node [input, name=input] (input) {};
		\node [block, below of=input, node distance=0cm] (A) {$
		\begin{matrix}
			\text{Filtro}\\
			\text{antialiasing}
		\end{matrix}$};
		\node [block, right of=A, node distance=2.5cm] (B) {ADC};
		\node [block, right of=B, node distance=2.5cm] (C) {$
		\begin{matrix}
			\text{Proceso}\\
			\text{digital}
		\end{matrix}$};
		\node [block, right of=C, node distance=2.5cm] (D) {DAC};
		\node [block, right of=D, node distance=2.5cm] (E) {$
		\begin{matrix}
			\text{Filtro de}\\
			\text{salida}
		\end{matrix}$};

		\draw [-angle 90] (-2,0) --  node{$x(t)$} (A);
		\draw [-angle 90] (A) --  node{$x'(t)$} (B);
		\draw [-angle 90] (B) --  node{$x[n]$} (C);
		\draw [-angle 90] (C) --  node{$y[n]$} (D);
		\draw [-angle 90] (D) --  node{$y'(t)$} (E);
		\draw [-angle 90] (E) --  node{$y(t)$} ++(2,0);
	\end{tikzpicture}
	\caption{Esquema de un sistema PDS} \label{fig:esquema_PDS}
\end{figure}

\newpage

\section{Muestreo}

Para realizar el muestreo de una señal sin que se produzca aliasing\footnote{El \textit{aliasing} es el solapamiento espectral no intencionado. Es producido por el submuestreo.} debemos asegurar que se cumple el \textbf{Teorema de Nyquist}

Este dice que la frecuencia de muestreo debe ser, al menos, el doble de la frecuencia máxima de la señal a muestrear\footnote{El subíndice ``s'' viene de \textit{sampling} (en inglés, muestreo). El subíndice ``m'' viene de \textit{max}.}:
\[ w_s \geq 2w_m \]
\section{Sistemas equivalentes. C/D y D/C)}

Para trabajar con sistemas continuos y discretos, se deben establecer unos criterios de equivalencia. En resumidas cuentas, los sistemas equivalentes se basan en la siguiente característica:

\[ H_D \left( e^{j\omega } \right) = \biggl. H_C \left( j\omega \right)  \biggr\vert _{\omega = \frac{\Omega}{T_s}} \]

\begin{center}
	\fbox{\begin{minipage}{0.85\linewidth}
		\textbf{Ejemplo 1.} Obtenga el sistema discreto que permite implementar el siguiente sistema LTI continuo:
		\[ H_C \left( j\omega \right) = \left\lbrace
			\begin{matrix*}[l]
				1	&, \abs{\omega }<\omega _c\\
				0	&, \text{ resto}
			\end{matrix*} \right. \]
		\begin{center}
			\underline{\textbf{Solución}}
		\end{center}
		\begin{align*}
			H_D \left( e^{j\omega} \right) & = \biggl. H_C \left( j\omega \right) \biggr\vert_{\omega = \frac{\Omega}{T_s}} = H_C \left( j \frac{\Omega}{T_s} \right) \quad , \abs{\Omega}<\pi \\[10pt]
			H_D \left( e^{j\omega} \right) & = \left\lbrace
			\begin{matrix*}[l]
				1 & , \abs{\frac{\Omega}{T_s} }<\omega _c\\
				0 & , \text{ resto}
			\end{matrix*} \right. = \boxed{\left\lbrace
				\begin{matrix*}[l]
					1 & , \abs{\Omega}<\omega _cT_s<\pi\\
					0 & , \text{ resto}
				\end{matrix*} \right.}
		\end{align*}
		Siempre y cuando se cumpla que $\omega_s\geq 2\omega_c$, podré emular en todo el rango de frecuencias de interés $H_c \left( j\omega \right)$

	\end{minipage}}
\end{center}

\begin{center}
	\fbox{\begin{minipage}{0.85\linewidth}
		\textbf{Ejemplo 2.} Encuentre el sistema discreto que permite implementar un diferenciador en tiempo continuo cuya relación entrada/salida es $ y_c(t) = \dv{}{t}x_c(t)$ entre $-\frac{\omega_s}{2}$ y $\frac{\omega_s}{2}$.

		\begin{center}
			\underline{\textbf{Solución}}
		\end{center}
\end{minipage}}
\end{center}


\section{ADC reales. Cuantificación}

\section{Cambio de la velocidad}

\chapter{La Transformada Discreta de Fourier (DFT)}

\section{Introducción}

Hay algunas cosas importantes que debemos recordar sobre la Transformada Discreta de Fourier:

\begin{itemize}
	\item La TF de una señal discreta es \textbf{periódica}, de periodo $2\pi$.
\end{itemize}

\section{Definición, cálculo, relaciones y propiedades}

\subsection{TF para señales periódicas}

\begin{multicols}{2}
	\subsubsection{Ecuación de síntesis}
	
	\[ x[n] = \sum_{k=<N>}^{}a_ke^{jk \frac{2\pi}{N} n}\]
	
	\subsubsection{Ecuación de análisis}
	
	\[ a_k = \frac{1}{N}\sum_{n=<N>}x[n]e^{-jk \frac{2\pi}{N}n} \]
	
\end{multicols}

\subsubsection{DFT}

Sea $x[n]$ una señal periódica de periodo $N$: \[ x[n] = \]

Podemos calcular su TF como:
\[ \TF{x[n]} = X(\Omega ) = 2\pi \sum_{k=<N>}a_k \cdot \delta \left( \Omega - \frac{2\pi}{N}k \right)\]

\section{Introducción al análisis espectral mediante la DFT}

\section{Filtrado de señales mediante la DFT}

\section{Ejercicios resueltos}


Calcular los coeficientes $a_k$ de la señal indicada a continuación: \[ x[n] = \sen \left( \frac{2\pi}{5}n \right) \]



\chapter{Diseño de filtros digitales} \label{temaDeFiltros}

\section{Introducción}

\section{Diseño de filtros FIR}

\section{Diseño de filtros IIR}

\section{Comparación entre métodos de diseño y tipos de filtros}

\section{Estructuras para la implementación de filtros digitales}

%%% FIN DE LOS APUNTES %%%

\end{document}
